!function(e){var t,n="states",o="transitions",f="length",r="push",a="call",i="from",s="to",l="args",c="*",u="undefined",p="StateMachine",d=Array.prototype.slice,v={"function":!0,object:!0},y=v[typeof window]&&window||v[typeof self]&&self||{};y[p]=function(e,y,g){var h=this,m=!1,x={},w=0,b=1,L=2,j=3;h.name=p,y=y||5,g=typeof g===u?1:g,h[n]=[],h[o]=[];var A=0,M=function(t,n){n=d[a](arguments,1),t>=g&&console.log.apply(console,[e+"("+x[i]+" -> "+x[s]+"):"].concat(n||[]))};h.log=M;var S=function(e){g=e};h.setLogLevel=S;var k=function(e,t,n,f){var a=[e,t,n,f];return h[o][r](a),a};h.add=k;var q=function(e,u){if(!m){var p,d,g,S,k;S=h[n],k=h[o],S[r](e),p=S[f]-y-2+y,d=S[p]||null,g=S[p+1],S.splice(0,S[f]-y),A=0;var q=function(e){var n=k[A],o=A;if(!n||n[w]!==d&&n[w]!==c||n[b]!==g&&n[b]!==c)o===A&&++A<k[f]&&q(e);else{var r=!1,u=function(e){m=!1,M(0,"after start"),n[j]&&(M(0,"before exit",e!==t?e:""),n[j][a](h,d,g,e),M(0,"after exit")),!r&&o===A&&++A<k[f]&&q(e)};x[i]=d,x[s]=g,x[l]=e,M(0,"before start",e!==t?e:""),v[typeof n[L]]?e=n[L][a](h,d,g,e,u):null!==n[L]?e=n[L]:e===t&&(e=null),e!==t&&(r=!0,u(e)),r||(m=!0)}};q(u)}};h.to=q},v[typeof define]&&v[typeof define.amd]&&define.amd?define(function(){return y[p]}):v[typeof exports]&&exports?exports[p]=y[p]:e[p]=y[p]}(this);