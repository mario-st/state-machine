!function(e){var t,n="states",o="transitions",r="length",f="push",a="call",i="splice",s="from",c="to",l="args",u="*",p="undefined",v="StateMachine",d=Array.prototype.slice,y={"function":!0,object:!0},g=y[typeof window]&&window||y[typeof self]&&self||{};g[v]=function(e,g,m){var h=this,x=!1,w={},b=0,L=1,j=2,A=3;h.name=v,g=g||5,m=typeof m===p?1:m,h[n]=[],h[o]=[];var M=0,S=function(t,n){n=d[a](arguments,1),t>=m&&console.log.apply(console,[e+"("+w[s]+" -> "+w[c]+"):"].concat(n||[]))};h.log=S;var k=function(e){m=e};h.setLogLevel=k;var q=function(e,t,n,r){var a=[e,t,n,r];return h[o][f](a),a};h.add=q;var z=function(e){for(var t=h[o],n=0,f=t[r];f>n;n++)if(t[n]===e)return void t[i](n,1)};h.remove=z;var B=function(e,p){if(!x){var v,d,m,k,q;k=h[n],q=h[o],k[f](e),v=k[r]-g-2+g,d=k[v]||null,m=k[v+1],k[i](0,k[r]-g),M=0;var z=function(e){var n=q[M],o=M;if(!n||n[b]!==d&&n[b]!==u||n[L]!==m&&n[L]!==u)o===M&&++M<q[r]&&z(e);else{var f=!1,i=function(e){x=!1,S(0,"after start"),n[A]&&(S(0,"before exit",e!==t?e:""),n[A][a](h,d,m,e),S(0,"after exit")),!f&&o===M&&++M<q[r]&&z(e)};w[s]=d,w[c]=m,w[l]=e,S(0,"before start",e!==t?e:""),y[typeof n[j]]?e=n[j][a](h,d,m,e,i):null!==n[j]?e=n[j]:e===t&&(e=null),e!==t&&(f=!0,i(e)),f||(x=!0)}};z(p)}};h.to=B},y[typeof define]&&y[typeof define.amd]&&define.amd?define(function(){return g[v]}):y[typeof exports]&&exports?exports[v]=g[v]:e[v]=g[v]}(this);