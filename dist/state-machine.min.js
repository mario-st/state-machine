!function(t){"undefined"==typeof exports&&(exports="object"==typeof window?window:"object"==typeof self?self:{});var e,n="states",r="transitions",o="length",i="push",f="call",a="splice",s="from",u="to",c="args",l="*",p="StateMachine",v={"function":!0};exports[p]=function(t){var d=this,h=!1,y={},m=0,x=1,b=2,w=3;d.name=p,t=t||5,d[n]=[],d[r]=[];var j=0,g=function(t,e,n,o){var f=[t,e,n,o];return d[r][i](f),f};d.add=g;var k=function(t){for(var e=d[r],n=0,i=e[o];i>n;n++)if(e[n]===t){e[a](n,1);break}return this};d.remove=k;var M=function(p,g,k){if(h)return this;var M,S,q,z,A;z=d[n],A=d[r],z[i](p),M=z[o]-t-2+t,S=z[M]||null,q=z[M+1],z[a](0,z[o]-t),j=0;var B=function(t){var n=A[j],r=j;if(!n||n[m]!==S&&n[m]!==l||n[x]!==q&&n[x]!==l)r===j&&++j<A[o]&&B(t);else{var i=!1,a=function(t){h=!1,n[w]&&n[w][f](d,S,q,t),k&&k[f](d,S,q,t),r===j&&++j<A[o]&&B(t)};y[s]=S,y[u]=q,y[c]=t,v[typeof n[b]]?t=n[b][f](d,S,q,t,a):null!==n[b]?t=n[b]:t===e&&(t=null),t!==e&&(i=!0,a(t)),i||(h=!0)}};return B(g),this};d.to=M};var d={"function":!0,object:!0};d[typeof define]&&d[typeof define.amd]&&define.amd?define(function(){return exports[p]}):t[p]=exports[p]}(this);