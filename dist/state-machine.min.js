!function(t){"undefined"==typeof exports&&(exports="object"==typeof window?window:"object"==typeof self?self:{});var e,n="states",o="transitions",r="length",i="push",f="call",a="splice",s="from",u="to",c="args",l="*",p="StateMachine",d={"function":!0},v={"function":!0,object:!0};exports[p]=function(t,v){var h=this,y=!1,m={},x=0,b=1,w=2,j=3;h.name=p,v=v||5,h[n]=[],h[o]=[];var g=0,k=function(t,e,n,r){var f=[t,e,n,r];return h[o][i](f),f};h.add=k;var M=function(t){for(var e=h[o],n=0,i=e[r];i>n;n++)if(e[n]===t){e[a](n,1);break}return this};h.remove=M;var S=function(t,p,k){if(y)return this;var M,S,q,z,A;z=h[n],A=h[o],z[i](t),M=z[r]-v-2+v,S=z[M]||null,q=z[M+1],z[a](0,z[r]-v),g=0;var B=function(t){var n=A[g],o=g;if(!n||n[x]!==S&&n[x]!==l||n[b]!==q&&n[b]!==l)o===g&&++g<A[r]&&B(t);else{var i=!1,a=function(t){y=!1,n[j]&&n[j][f](h,S,q,t),k&&k[f](h,S,q,t),o===g&&++g<A[r]&&B(t)};m[s]=S,m[u]=q,m[c]=t,d[typeof n[w]]?t=n[w][f](h,S,q,t,a):null!==n[w]?t=n[w]:t===e&&(t=null),t!==e&&(i=!0,a(t)),i||(y=!0)}};return B(p),this};h.to=S},v[typeof define]&&v[typeof define.amd]&&define.amd?define(function(){return exports[p]}):t[p]=exports[p]}(this);